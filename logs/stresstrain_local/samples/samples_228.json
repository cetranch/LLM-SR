{"sample_order": 228, "function": "def equation(strain: np.ndarray, temp: np.ndarray, params: np.ndarray) -> np.ndarray:\n    \"\"\" Mathematical function for stress in Aluminium rod\n\n    Args:\n        strain: A numpy array representing observations of strain.\n        temp: A numpy array representing observations of temperature.\n        params: Array of numeric constants or parameters to be optimized\n\n    Return:\n        A numpy array representing stress as the result of applying the mathematical function to the inputs.\n    \"\"\"\n    E, T_ref = params[0], params[1]\n    s_y = params[2:].reshape(-1, 1)\n    \n    # modify the array of strains to be a matrix of [-np.strain, np.strain] for both elastic and plastic regions\n    strains_T = np.stack([np.min(strain, axis=1).reshape(-1, 1), np.max(strain, axis=1).reshape(-1, 1)], axis=-1)\n    \n    strains_T_linux = strains_T + np.eye(len(strains_T))*1e-6  # Adding lower bound to prevent singularity.\n    \n    exp_term = np.exp((strains_T - s_y) / T_ref)\n    strains_T_exp = np.where(np.all((strains_T >= 0), axis=1), exp_term, np.zeros_like(exp_term)) # Setting exp_term to 0 wherever strains are negative\n    \n    strain_matrix = np.column_stack((np.min(strain, axis=1), np.max(strain, axis=1)))\n\n", "score": null}